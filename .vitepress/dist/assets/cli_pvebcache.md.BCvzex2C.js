import{_ as e,c as i,o as s,ah as c}from"./chunks/framework.HzbgFGQH.js";const o=JSON.parse('{"title":"pvebcache","description":"","frontmatter":{},"headers":[],"relativePath":"cli/pvebcache.md","filePath":"cli/pvebcache.md"}'),h={name:"cli/pvebcache.md"};function t(n,a,l,p,r,d){return s(),i("div",null,a[0]||(a[0]=[c(`<h1 id="pvebcache" tabindex="-1">pvebcache <a class="header-anchor" href="#pvebcache" aria-label="Permalink to “pvebcache”">​</a></h1><p><code>pvebcache</code>是pxvirt的bcache管理工具。</p><h2 id="create" tabindex="-1">create <a class="header-anchor" href="#create" aria-label="Permalink to “create”">​</a></h2><p><code>pvebcache create </code>用于将一个磁盘设备变成bcache后端设备。</p><p><code>pvebcache create /dev/sdb</code> 将<code>/dev/sdb</code>转成bcache设备。</p><h2 id="list" tabindex="-1">list <a class="header-anchor" href="#list" aria-label="Permalink to “list”">​</a></h2><p>如下可以查看bcache相关的设备。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@pvedevel:~#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pvebcache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       backend-dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          cache-dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            cachemode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bcache0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    sdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  unknown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              Running</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         80GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            writeback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nvme0n1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    cache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      unknown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              unknown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              Running</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         32GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            unknown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@pvedevel:~#</span></span></code></pre></div><h2 id="stop" tabindex="-1">stop <a class="header-anchor" href="#stop" aria-label="Permalink to “stop”">​</a></h2><p>停止相关的bcache后端设备</p><p><code>pvebcache stop bcache0</code></p><h2 id="register" tabindex="-1">register <a class="header-anchor" href="#register" aria-label="Permalink to “register”">​</a></h2><p>重新注册bcache设备</p><p><code>pvebcache register /dev/sdb</code></p><h2 id="cache-create" tabindex="-1">cache create <a class="header-anchor" href="#cache-create" aria-label="Permalink to “cache create”">​</a></h2><p>创建cache设备</p><p><code>pvebcache cache create /dev/nvme0n1p1</code></p><h2 id="cache-stop" tabindex="-1">cache stop <a class="header-anchor" href="#cache-stop" aria-label="Permalink to “cache stop”">​</a></h2><p>停止cache设备。如果cache设备正在使用，则无法停止。</p><p><code>pvebcache cache stop /dev/nvme0n1p1</code></p><h2 id="cache-attach" tabindex="-1">cache attach <a class="header-anchor" href="#cache-attach" aria-label="Permalink to “cache attach”">​</a></h2><p>将cache设备和后端设备绑定</p><p><code>pvebcache cache attach bcache0 --cache /dev/nvme0n1p1</code></p><h2 id="cache-detach" tabindex="-1">cache detach <a class="header-anchor" href="#cache-detach" aria-label="Permalink to “cache detach”">​</a></h2><p>将后端设备和缓存设备分离</p><p><code>pvebcache cache detach bcache0</code></p><h2 id="cache-set" tabindex="-1">cache set <a class="header-anchor" href="#cache-set" aria-label="Permalink to “cache set”">​</a></h2><p>设置后端设备的缓存策略</p><ul><li>cachemode # 缓存模式 <ul><li>writethrough</li><li>writeback</li><li>writearound</li><li>none</li></ul></li><li>sequential #顺序id大小，单位为kb</li><li>wb-percent #回写的百分比</li><li>clear-stats #清除统计数据</li></ul><p><code>pvebcache cache set bcache0 --cachemode writeback --sequential 4096 --wb-percent 20</code></p><p>如上命令，将bcache0缓存设置为<code>writeback</code>，顺序io大小为4M，回写的百分比为20%</p>`,31)]))}const b=e(h,[["render",t]]);export{o as __pageData,b as default};
